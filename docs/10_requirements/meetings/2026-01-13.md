---
title: 2026-01-13
parent: 회의록
grand_parent: TR1L (Overview)
nav_order: 20260113
---

# 2026-01-13 정산→청구서→발송 연동 구조 확정 및 개인정보 처리 범위 정리

## 1) 개요
- **날짜** : 2026-01-13
- **참여자** :


<!-- Participants -->
<div class="tr1l-participants" aria-label="participants">
  <a class="tr1l-chip" href="https://github.com/Jsnooopy" aria-label="이재 GitHub">
    <img class="tr1l-avatar" src="https://github.com/Jsnooopy.png?size=120" alt="이재" />
    <span class="tr1l-name">이재</span>
  </a>

  <a class="tr1l-chip" href="https://github.com/tkv00" aria-label="김도연 GitHub">
    <img class="tr1l-avatar" src="https://github.com/tkv00.png?size=120" alt="김도연" />
    <span class="tr1l-name">김도연</span>
  </a>

  <a class="tr1l-chip" href="https://github.com/ChoiSeungeon" aria-label="최승언 GitHub">
    <img class="tr1l-avatar" src="https://github.com/ChoiSeungeon.png?size=120" alt="최승언" />
    <span class="tr1l-name">최승언</span>
  </a>

  <a class="tr1l-chip" href="https://github.com/bon0512" aria-label="구본문 GitHub">
    <img class="tr1l-avatar" src="https://github.com/bon0512.png?size=120" alt="구본문" />
    <span class="tr1l-name">구본문</span>
  </a>

  <a class="tr1l-chip" href="https://github.com/marulog" aria-label="박준희 GitHub">
    <img class="tr1l-avatar" src="https://github.com/marulog.png?size=120" alt="박준희" />
    <span class="tr1l-name">박준희</span>
  </a>

  <a class="tr1l-chip" href="https://github.com/cylin0201" aria-label="김원기 GitHub">
    <img class="tr1l-avatar" src="https://github.com/cylin0201.png?size=120" alt="김원기" />
    <span class="tr1l-name">김원기</span>
  </a>
</div>

<style>
  .tr1l-participants{
    display:flex; flex-wrap:wrap; gap:10px;
    align-items:center; margin:8px 0 2px;
  }
  .tr1l-chip{
    display:inline-flex; align-items:center; gap:10px;
    padding:8px 12px; border-radius:999px;
    text-decoration:none !important;
    border:1px solid rgba(127,127,127,.28);
    background:rgba(127,127,127,.10);
    backdrop-filter:saturate(140%) blur(4px);
    transition:transform .12s ease, border-color .12s ease, background .12s ease;
  }
  .tr1l-chip:hover{
    transform:translateY(-1px);
    border-color:rgba(127,127,127,.45);
    background:rgba(127,127,127,.14);
  }
  .tr1l-avatar{
    width:28px; height:28px; border-radius:50%;
    display:block; flex:0 0 auto;
    box-shadow:0 0 0 1px rgba(127,127,127,.22);
  }
  .tr1l-name{
    font-weight:650; font-size:14px;
    line-height:1; letter-spacing:-0.2px;
    color:inherit;
  }
</style>


---

## 2) 목표(Goal)
발송 실패/정책 변경/종착지(이메일·전화번호) 전달 방식과  
개인정보 보안(암·복호화) 처리까지 포함한 **“정산 → 청구서 → 발송” 연동 구조**를 확정한다.

---

## 3) 회의 주제 / Agenda
|  Time | Topic               | Note                                             |
|------:|---------------------|--------------------------------------------------|
| 13:00 | 배치, 카프카 전달 방식 구조 확정 | 종착지(이메일/전화번호) 제공 방식 / 개인정보 보안: 암호화·복호화·마스킹 처리 범위 |

---

## 4) 데일리 스크럼

### 4.1 진행 상황 공유
| 이름  | 진행 상황                          |
|-----|--------------------------------|
| 이재  | ECS/Fargate 아키텍쳐 설계 완료         |
| 김도연 | BackEnd Repository 디렉토리 구조 셋업  |
| 구본문 | 인프런 배치 공부                      |
| 박준희 | 인프런 배치 공부, 배치 시퀀스 다이어그램 작성 완료  |
| 김원기 | 카프카 실습                         |
| 최승언 | 인프런 카프카 공부 완료 및 카프카 구조 대략적인 설계 |

### 4.2 계획 공유
| 이름  | 해야 할 일                                                                                    |
|-----|-------------------------------------------------------------------------------------------|
| 이재  | 리드미 파일 작성, 아키텍쳐 구축                                                                        |
| 김도연 | 모듈별 application 파일 설정, 분리된 Dockerfile 작성 및 실행 방법 명시, Billing Domain model 구현, 전역 예외 처리 구현 |
| 구본문 | 인프런 배치 공부, 배치 스텝 설계                                                                       |
| 박준희 | 인프런 배치 공부, 리드미 정리                                                                         |
| 김원기 | 카프카 구조 확정, 리드미에 들어갈 내용 작성                                                                 |
| 최승언 | 카프카 구조 확정, 리드미에 들어갈 내용 작성                                                                 |

---

## 5) 협업 요청
| 요청자 | 대상    | 요청 내용         | 이유/맥락         | 마감               | 결과물                   |
|-----|-------|---------------|---------------|------------------|-----------------------|
| 이재  | 팀원 전원 | 각 파트 설계 내용 정리 | README 파일 작성용 | 2026-01-13 22:00 | Confluence 파트별 공간 페이지 |

---

## 6) 회의 내용(Notes)

### 6.1 채널 확장 시 “미리 템플릿 생성” 낭비 vs 운영 현실
- 이메일/SMS 외 푸시 등 채널이 늘어나면 **모든 채널 템플릿을 미리 대량 생성(S3 저장)**하는 방식이 낭비일 수 있음.
- 반면, 발송 실패는 **배치 종료 이후**에 발생하며 배치가 꺼진 상태에서 실패를 다시 배치로 되돌리는 구조는 자연스럽지 않음.
  - 재처리는 **“트리거로 배치를 다시 깨워서 수행”**하는 방향 논의.
- 결론적으로 배치는 **상시 실행이 아니라 필요 시 트리거로 켜서 실행**되는 형태로 가정
  - (인프라 오토스케일링 / 스케줄 기반)

---

### 6.2 정책 변경(채널 우선순위) 및 버전 관리 방식
- 발송 정책(예: 이메일 → SMS → 카카오톡)은 **파라미터 주입 방식**이 적합하다고 논의.
- 버전(version) 활용:
  - **v0**: 최초 생성/발송 대상
  - **v1**: 1차 실패 케이스 재처리 대상
- 정책 변경 시:
  - 파라미터 변경 + 버전 전략 재정의
  - 필요 시 v0 재생성 또는 상태 기준 재생성
- 핵심: 정책 변경/실패 재처리 상황에서도 **전체 재배치가 아니라 실패 대상 중심**으로 재생성/재발송 가능해야 함.

---

### 6.3 실패 건 전달/상태 업데이트 방식
- 실패/성공 상태를 실시간으로 업데이트해야 **중복 발송 방지**가 가능 → 조회/갱신 반복은 불가피.
- DynamoDB 등 대안도 언급되었으나,
  - 배치/Kafka 파트가 여러 DB(Postgres + Mongo + Dynamo)를 동시에 들고 가면 운영 복잡도 증가
  - 커넥션/IO 부담 우려
- “이벤트로 배치가 리슨” 구조는 배치 특성상 부적합
- 결론 방향: 실패/성공 상태는 **DB 기반 또는 별도 결과 테이블 기반**으로 관리가 유력

---

### 6.4 종착지(이메일/전화번호) 제공 방식: S3 CSV vs 전용 테이블
- Kafka 발송 파트는 발송을 위해 **user 식별자 + 채널별 종착지(이메일/전화번호)** 필요.
- DB 공유를 피하면 S3에 CSV로 종착지 목록을 저장/읽는 방식이 제안되었으나,
  - **100만 건 CSV 읽기 비용/병렬성/지연** 이슈가 논의됨.
- 결론적으로 **“완료 결과 전용 테이블(배치 결과물)”**을 만들어
  - `userId + destination(이메일/전화번호) + s3Url(or invoiceKey)` 정도만 담아주면
  - Kafka 발송 파트가 유저 DB를 직접 조회하지 않고도 발송 준비 가능
- ‘유저 DB 직접 조회’보다 **전용 결과 테이블**이 더 깔끔하다는 쪽으로 합의가 형성됨.

---

### 6.5 개인정보 보호: 암·복호화 / 마스킹 처리 범위
- 원칙: DB에 저장되는 개인정보(이메일/전화번호 등)는 **암호화된 상태로 저장**되어야 함.
- Job 흐름 상 필요 시점에만 복호화:
  - 청구서 파일 생성(S3 업로드) 시 복호화/마스킹 적용 가능
  - 발송 파트도 목적지 사용을 위해 복호화가 필요할 수 있음
- 공통 과제:
  - 키 관리/공통 유틸을 어떻게 공유할지(대칭키/비대칭키, 공통 모듈화 등) 추가 논의 필요
- 더미 데이터 적재 시에도 “암호화된 값”을 넣어야 하므로
  - 테스트 데이터 생성 방식도 별도로 정의 필요

---

### 6.6 멘토링 대비 산출물 정리(22시 마감)
- 멘토링용 README 작성 목적에 맞게,
  - 각 파트가 현재 설계 내용을 **Confluence 파트별 페이지에 정리**
- 질문 리스트도 각 파트별로 적어두고,
  - 이재가 취합 예정

---

## 7) 조치 항목(Action Items)
- [ ] 발송용 완료 결과 테이블 스키마 초안 작성
- [ ] 암·복호화/마스킹 적용 지점 명확화
- [ ] 파트별 설계 정리 + 멘토링 질문 목록 작성
- [ ] 멘토링 README 최종 취합/작성
- [ ] DynamoDB/대안(커넥션·비용·장단점) 짧게 조사
